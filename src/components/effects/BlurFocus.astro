---
/*
INFORMATIONS:
set
- imagePath as string
set optionally:
- class as string
- duration as string 'value and s | ms'
- width and/or height as numbers
- format as string
- loading as 'lazy' | 'eager' | null
*/

import { Image } from 'astro:assets';

interface Props {
  imagePath: string;
  class?: string;
  duration?: string;
  width?: number;
  height?: number;
  format?: string;
  loading?: 'lazy' | 'eager' | null;
}

// prettier-ignore
const { class: classList, duration='1s', imagePath, width=400, height, format = 'webp', loading='lazy', ...attrs  } = Astro.props;

const images = import.meta.glob<{ default: ImageMetadata }>(
  '/src/**/*.{jpg,jpeg,png,webp,avif,svg,gif,eps,raw,bmp,tiff,ico}'
);
if (!images[imagePath]) throw new Error(`${imagePath} does not exist`);
---

<div class:list={[classList, 'container']} {...attrs}>
  <slot />
  <Image
    src={images[imagePath]()}
    alt="#"
    width={width}
    height={height}
    format={format}
    loading={loading}
  />
</div>

<style define:vars={{ width, height, duration }}>
  .container {
    display: flex;
    position: relative;
    justify-content: center;
    align-items: center;
    width: 25rem;
    height: 12.5rem;
    overflow: clip;
    img {
      display: block;
      position: absolute;
      transform: scale(1.3);
      filter: blur(2px);
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      object-position: right top;
    }
    img,
    h3 {
      transition: var(--duration);
    }
    h3 {
      z-index: 1;
      color: white;
      font-weight: 800;
      font-size: 2rem;
      text-shadow: 0 5px 25px #00000033;
    }
    &:hover {
      h3 {
        transform: scale(1.2);
        filter: blur(2px);
      }
      img {
        top: 0;
        left: 0;
        transform: scale(1);
        filter: blur(0px);
      }
    }
  }
</style>
