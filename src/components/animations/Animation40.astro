---
/*
INFORMATIONS
set optionally:
- class as string
- duration as string 'value and s | ms'
- colors as string ("<color>, <hoverColor>") 
*/

interface Props {
  href: string;
  class?: string;
  duration?: string;
  colors?: string;
}
const {
  href = '#',
  class: classList,
  duration = '.5s',
  colors = '#03e9f4, #051130',
  ...attrs
} = Astro.props;
const [color, hoverColor] = colors.split(',');

const regex = /(?<quantity>[\d\.]+)(?<unit>[a-z]+)/;
const result = duration.match(regex)!;
const quantity = +result.groups?.quantity!;
const unit = result.groups?.unit!;

const style = `--duration: ${duration};--color: ${color};--hoverColor: ${hoverColor};`;
const id = Math.random().toString(32).slice(2, 11);
---

<div id={id} class:list={['container40', classList]} style={style} {...attrs}>
  <a href={href}>
    {
      Array.from({ length: 4 }).map((_, idx) => {
        const delay = `${(quantity / 2) * idx}${unit}`;
        return <div class="border" style={`animation-delay: ${delay}`} />;
      })
    }
    <slot />
  </a>
</div>

<style>
  .container40 {
    background: #001d30;
    padding: 0.5em;
    width: fit-content;
    font-size: 1.5rem;
    line-height: 1;
    text-align: center;
    @supports (
      -webkit-box-reflect: below -4em linear-gradient(transparent, #0005)
    ) {
      height: var(--height);
    }
    a {
      display: inline-block;
      position: relative;
      transition: var(--duration);
      padding: 0.3em 0.7em;
      color: var(--color);
      text-decoration: none;
      -webkit-box-reflect: below 1px linear-gradient(transparent, #0005);
      overflow: clip;
      .border {
        position: absolute;

        &:nth-of-type(1) {
          top: 0;
          left: -100%;
          animation: anim43_1 calc(var(--duration) * 2) linear infinite;
          background: linear-gradient(to right, transparent, var(--color));
          width: 100%;
          height: 2px;
        }
        &:nth-of-type(2) {
          top: -100%;
          right: 0;
          animation: anim43_2 calc(var(--duration) * 2) linear infinite;
          background: linear-gradient(to bottom, transparent, var(--color));
          width: 2px;
          height: 100%;
        }
        &:nth-of-type(3) {
          right: -100%;
          bottom: 0;
          animation: anim43_3 calc(var(--duration) * 2) linear infinite;
          background: linear-gradient(to left, transparent, var(--color));
          width: 100%;
          height: 2px;
        }
        &:nth-of-type(4) {
          bottom: -100%;
          left: 0;
          animation: anim43_4 calc(var(--duration) * 2) linear infinite;
          background: linear-gradient(to top, transparent, var(--color));
          width: 2px;
          height: 100%;
        }
      }

      &:hover {
        box-shadow:
          0 0 0.2em var(--color),
          0 0 1em var(--color),
          0 0 2em var(--color),
          0 0 8em var(--color);
        background-color: var(--color);
        color: var(--hoverColor);
      }
    }
  }

  @keyframes anim43_1 {
    0% {
      left: -100%;
    }
    50%,
    100% {
      left: 100%;
    }
  }
  @keyframes anim43_2 {
    0% {
      top: -100%;
    }
    50%,
    100% {
      top: 100%;
    }
  }
  @keyframes anim43_3 {
    0% {
      right: -100%;
    }
    50%,
    100% {
      right: 100%;
    }
  }
  @keyframes anim43_4 {
    0% {
      bottom: -100%;
    }
    50%,
    100% {
      bottom: 100%;
    }
  }
</style>

<script define:vars={{ id }}>
  const container40 = document.getElementById(id);
  const anchor = container40.querySelector('a');

  const containerPaddingY = Math.max(
    parseFloat(getComputedStyle(container40).paddingBottom),
    parseFloat(getComputedStyle(container40).paddingTop)
  );
  const anchorHeight = parseFloat(getComputedStyle(anchor).height);

  container40.style.cssText += `--height: ${(anchorHeight + containerPaddingY) * 2}px;`;
</script>
