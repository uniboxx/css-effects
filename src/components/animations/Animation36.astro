---
/*
INFORMATIONS
set optionally:
- class as string
- duration as string 'value and s | ms'
- size as string
- colors as string ("<color>, <bgColor>") 
*/

interface Props {
  class?: string;
  duration?: string;
  size?: string;
  colors?: string;
}
const {
  class: classList,
  size = '3rem',
  colors = '#fff, #00e1ffaa',
  duration = '2s',
  ...attrs
} = Astro.props;

const [color, bgColor] = colors.split(',');

const style = `--duration: ${duration};--size: ${size};--color: ${color};--bgColor: ${bgColor};`;
---

<div class:list={['container36', classList]} style={style} {...attrs}>
  <div class="content">
    <div class="cloud"></div>
    <div class="rain">
      {
        Array.from({ length: 20 }).map((_, idx) => {
          const delay = `calc(${Math.random().toFixed(2)} * var(--duration))`;
          return <span style={`--n: ${idx};--delay: ${delay}`} />;
        })
      }
    </div>
  </div>
</div>

<style>
  .container36 {
    display: flex;
    justify-content: center;
    align-items: center;
    background: var(--bgColor);
    padding-bottom: 1rem;
    width: fit-content;
    .content {
      position: relative;
      border-bottom: calc(var(--size) * 0.06) solid var(--color);
      width: calc(var(--size) * 3.3);
      height: calc(var(--size) * 3.83);
      .cloud {
        position: relative;
        top: calc(var(--size));
        border-radius: var(--size);
        background: var(--color);
        height: var(--size);
        &::before,
        &::after {
          position: absolute;
          border-radius: 50%;
          background: var(--color);
          content: '';
        }
        &::before {
          top: calc(var(--size) / -2);
          left: calc(var(--size) / 5 * 2);
          width: calc(var(--size) * 1.1);
          height: calc(var(--size) * 1.1);
        }
        &::after {
          top: calc(var(--size) / -1.2);
          left: calc(var(--size) * 1.2);
          width: calc(var(--size) * 1.6);
          height: calc(var(--size) * 1.6);
        }
      }
      .rain {
        --spanSize: calc(var(--size) * 0.06);
        position: relative;
        top: calc(var(--size) / 1.3);
        z-index: 1;
        margin: 0 auto;
        width: 90%;
        height: calc(var(--size) * 2.01 - var(--spanSize));
        span {
          position: absolute;
          top: 0%;
          left: calc(var(--n) * 5%);
          transform-origin: bottom;
          animation: rain36 var(--duration) linear infinite;
          animation-delay: var(--delay);
          border-radius: 50%;
          background: var(--color);
          width: var(--spanSize);
          height: var(--spanSize);
        }
      }
    }
  }

  @keyframes rain36 {
    0% {
      top: 0;
      transform: scale(1);
    }
    70% {
      top: 100%;
      transform: scale(1);
    }
    100% {
      top: 100%;
      transform: scale(0);
    }
  }
</style>
