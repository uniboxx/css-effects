---
/*
INFORMATIONS
set optionally:
- class as string
- duration as string 'value and s | ms'
*/

interface Props {
  class?: string;
  duration?: string;
}
const { class: classList, duration = '3s', ...attrs } = Astro.props;
const style = `--duration: ${duration};`;

const id = Math.random().toString(32).slice(2, 11);
---

<div
  id={id}
  class:list={['container19', classList]}
  style={style}
  data-duration={duration}
  {...attrs}
>
  <h3><slot /></h3>
</div>

<style>
  .container19 {
    transition: calc(var(--duration) / 1.5);
    padding: 2em 1em;
    width: 20rem;
    max-width: 100%;
    text-align: center;
    h3 {
      font-size: 2rem;
    }
  }
</style>

<script define:vars={{ id, duration }}>
  const container = document.getElementById(id);

  const time = duration.match('ms')
    ? parseFloat(duration)
    : parseFloat(duration) * 1000;

  function hslGen() {
    const h = Math.floor(Math.random() * 361);
    const s = parseFloat(
      (Math.trunc(Math.random() * (100 * 10 + 1)) / 10).toFixed(1)
    );
    const l = parseFloat(
      (Math.trunc(Math.random() * (100 * 10 + 1)) / 10).toFixed(1)
    );
    return {
      bg: `hsl(${h} ${s}% ${l}%)`,
      color: `hsl(${(h + 170) % 360} ${s}% ${Math.round((100 - l) * 10) / 10}%)`,
    };
  }
  function changeBg() {
    const colors = hslGen();
    container.style.backgroundColor = colors.bg;
    container.style.color = colors.color;
  }
  setInterval(changeBg, time);
  changeBg();
</script>
